[2025-04-05T11:34:55.677+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: descargar_y_ver_dataset.split_dataset manual__2025-04-05T11:34:49.469612+00:00 [queued]>
[2025-04-05T11:34:55.681+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: descargar_y_ver_dataset.split_dataset manual__2025-04-05T11:34:49.469612+00:00 [queued]>
[2025-04-05T11:34:55.681+0000] {taskinstance.py:1362} INFO - 
--------------------------------------------------------------------------------
[2025-04-05T11:34:55.681+0000] {taskinstance.py:1363} INFO - Starting attempt 1 of 1
[2025-04-05T11:34:55.681+0000] {taskinstance.py:1364} INFO - 
--------------------------------------------------------------------------------
[2025-04-05T11:34:55.686+0000] {taskinstance.py:1383} INFO - Executing <Task(PythonOperator): split_dataset> on 2025-04-05 11:34:49.469612+00:00
[2025-04-05T11:34:55.689+0000] {standard_task_runner.py:54} INFO - Started process 2988 to run task
[2025-04-05T11:34:55.691+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'descargar_y_ver_dataset', 'split_dataset', 'manual__2025-04-05T11:34:49.469612+00:00', '--job-id', '36', '--raw', '--subdir', 'DAGS_FOLDER/ml_dust_pred_dag.py', '--cfg-path', '/tmp/tmpkdkbm6f1']
[2025-04-05T11:34:55.691+0000] {standard_task_runner.py:83} INFO - Job 36: Subtask split_dataset
[2025-04-05T11:34:55.692+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/***/dags/ml_dust_pred_dag.py
[2025-04-05T11:34:55.801+0000] {task_command.py:384} INFO - Running <TaskInstance: descargar_y_ver_dataset.split_dataset manual__2025-04-05T11:34:49.469612+00:00 [running]> on host 6d3c9c1b3c45
[2025-04-05T11:34:55.826+0000] {taskinstance.py:1592} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=descargar_y_ver_dataset
AIRFLOW_CTX_TASK_ID=split_dataset
AIRFLOW_CTX_EXECUTION_DATE=2025-04-05T11:34:49.469612+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2025-04-05T11:34:49.469612+00:00
[2025-04-05T11:34:56.081+0000] {logging_mixin.py:117} INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 3006 entries, 0 to 3005
Data columns (total 30 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   TempOut    3006 non-null   float64
 1   OutHum     3006 non-null   float64
 2   DewPt.     3006 non-null   float64
 3   WSpeed     3006 non-null   float64
 4   WRun       3006 non-null   float64
 5   WHSpeed    3006 non-null   float64
 6   WChill     3006 non-null   float64
 7   HeatIx     3006 non-null   float64
 8   ThwIx      3006 non-null   float64
 9   ThswI      3006 non-null   float64
 10  Bar        3006 non-null   float64
 11  Rain       3006 non-null   float64
 12  HiSlE      3006 non-null   float64
 13  Rad.       3006 non-null   float64
 14  uvIndex    3006 non-null   float64
 15  uDose      3006 non-null   float64
 16  hiUV       3006 non-null   float64
 17  hetD-D     3006 non-null   float64
 18  colD-D     3006 non-null   float64
 19  inTemp     3006 non-null   float64
 20  inHum      3006 non-null   float64
 21  inDew      3006 non-null   float64
 22  iHeat      3006 non-null   float64
 23  ET         3006 non-null   float64
 24  WSamp      3006 non-null   int64  
 25  iRecept    3006 non-null   float64
 26  WDir_deg   3006 non-null   float64
 27  HWDir_deg  3006 non-null   float64
 28  clase      3006 non-null   bool   
 29  Date_num   3006 non-null   float64
dtypes: bool(1), float64(28), int64(1)
memory usage: 684.1 KB
[2025-04-05T11:34:56.081+0000] {logging_mixin.py:117} INFO - None
[2025-04-05T11:34:56.083+0000] {logging_mixin.py:117} INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 3006 entries, 0 to 3005
Data columns (total 29 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   TempOut    3006 non-null   float64
 1   OutHum     3006 non-null   float64
 2   DewPt.     3006 non-null   float64
 3   WSpeed     3006 non-null   float64
 4   WRun       3006 non-null   float64
 5   WHSpeed    3006 non-null   float64
 6   WChill     3006 non-null   float64
 7   HeatIx     3006 non-null   float64
 8   ThwIx      3006 non-null   float64
 9   ThswI      3006 non-null   float64
 10  Bar        3006 non-null   float64
 11  Rain       3006 non-null   float64
 12  HiSlE      3006 non-null   float64
 13  Rad.       3006 non-null   float64
 14  uvIndex    3006 non-null   float64
 15  uDose      3006 non-null   float64
 16  hiUV       3006 non-null   float64
 17  hetD-D     3006 non-null   float64
 18  colD-D     3006 non-null   float64
 19  inTemp     3006 non-null   float64
 20  inHum      3006 non-null   float64
 21  inDew      3006 non-null   float64
 22  iHeat      3006 non-null   float64
 23  ET         3006 non-null   float64
 24  WSamp      3006 non-null   int64  
 25  iRecept    3006 non-null   float64
 26  WDir_deg   3006 non-null   float64
 27  HWDir_deg  3006 non-null   float64
 28  Date_num   3006 non-null   float64
dtypes: float64(28), int64(1)
memory usage: 681.2 KB
[2025-04-05T11:34:56.083+0000] {logging_mixin.py:117} INFO - None
[2025-04-05T11:34:56.084+0000] {logging_mixin.py:117} INFO - 0       False
1       False
2       False
3       False
4       False
        ...  
3001    False
3002    False
3003    False
3004    False
3005    False
Name: clase, Length: 3006, dtype: bool
[2025-04-05T11:34:56.085+0000] {logging_mixin.py:117} INFO - âœ… Split realizado con Ã©xito.
[2025-04-05T11:34:56.085+0000] {logging_mixin.py:117} INFO - ðŸ“Š TamaÃ±o del conjunto de entrenamiento: 2104
[2025-04-05T11:34:56.085+0000] {logging_mixin.py:117} INFO - ðŸ“ˆ TamaÃ±o del conjunto de prueba: 902
[2025-04-05T11:34:56.085+0000] {taskinstance.py:1851} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 175, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 193, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/ml_dust_pred_dag.py", line 72, in split_dataset
    X_train_svm.to_json(os.path.join(output_dir, "X_train.json"), orient="records")
NameError: name 'os' is not defined
[2025-04-05T11:34:56.090+0000] {taskinstance.py:1406} INFO - Marking task as FAILED. dag_id=descargar_y_ver_dataset, task_id=split_dataset, execution_date=20250405T113449, start_date=20250405T113455, end_date=20250405T113456
[2025-04-05T11:34:56.094+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 36 for task split_dataset (name 'os' is not defined; 2988)
[2025-04-05T11:34:56.129+0000] {local_task_job.py:164} INFO - Task exited with return code 1
[2025-04-05T11:34:56.138+0000] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
